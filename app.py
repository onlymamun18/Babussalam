import streamlit as st
import pandas as pd

# ржЖржкржирж╛рж░ ржЧрзБржЧрж▓ рж╢рж┐ржЯ ржХрж╛ржирзЗржХрж╢ржи
SHEET_ID = '1TRbxG151RFzNdKbQ7KShWWV1MJHIVxSNdF-rSfLMde0'
SHEET_NAME = 'Sheet1' # ржЖржкржирж╛рж░ рж╢рж┐ржЯрзЗрж░ ржирж╛ржо Sheet1 ржЗ ржЖржЫрзЗ
url = f'https://docs.google.com/spreadsheets/d/{SHEET_ID}/gviz/tq?tqx=out:csv&sheet={SHEET_NAME}'

# ржЕрзНржпрж╛ржкрзЗрж░ ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи
st.set_page_config(page_title="ржмрж╛ржмрзБрж╕ рж╕рж╛рж▓рж╛ржо ржЗрж╕рж▓рж╛ржорж┐ ржПржХрж╛ржбрзЗржорж┐", page_icon="ЁЯХМ", layout="centered")

st.markdown("<h1 style='text-align: center; color: #008080;'>ЁЯХМ ржмрж╛ржмрзБрж╕ рж╕рж╛рж▓рж╛ржо ржЗрж╕рж▓рж╛ржорж┐ ржПржХрж╛ржбрзЗржорж┐</h1>", unsafe_allow_html=True)
st.markdown("<p style='text-align: center;'>ржбрж┐ржЬрж┐ржЯрж╛рж▓ рждржерзНржп ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрзЗржирзНржжрзНрж░</p>", unsafe_allow_html=True)
st.write("---")

# ржЧрзБржЧрж▓ рж╢рж┐ржЯ ржерзЗржХрзЗ ржбрж╛ржЯрж╛ ржкрзЬрж╛рж░ ржлрж╛ржВрж╢ржи
def load_data():
    try:
        # cache_data ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ ржпрж╛рждрзЗ ржмрж╛рж░ржмрж╛рж░ рж▓рзЛржб ржирж╛ рж╣рзЯ
        return pd.read_csv(url)
    except Exception as e:
        st.error("ржбрж╛ржЯрж╛ржмрзЗрж╕ ржХрж╛ржирзЗржХрзНржЯ ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржЪрзНржЫрзЗред ржжрзЯрж╛ ржХрж░рзЗ ржЗржирзНржЯрж╛рж░ржирзЗржЯ ржЪрзЗржХ ржХрж░рзБржиред")
        return None

df = load_data()

# рж╕рж╛рж░рзНржЪ ржмржХрзНрж╕
st.subheader("ЁЯФН ржЖржЗржбрж┐ ржжрж┐рзЯрзЗ рждржерзНржп ржЦрзБржБржЬрзБржи")
search_id = st.text_input("ржПржЦрж╛ржирзЗ ржЫрж╛рждрзНрж░ ржмрж╛ рж╢рж┐ржХрзНрж╖ржХрзЗрж░ ржЖржЗржбрж┐ ржиржорзНржмрж░ржЯрж┐ рж▓рж┐ржЦрзБржи:", placeholder="ржпрзЗржоржи: 101")

if st.button("рж╕рж╛рж░рзНржЪ ржХрж░рзБржи"):
    if df is not None:
        if search_id:
            # ржЖржЗржбрж┐ ржжрж┐рзЯрзЗ ржбрж╛ржЯрж╛ ржЦрзЛржБржЬрж╛ (ржЖржЗржбрж┐ ржХрж▓рж╛ржоржЯрж┐ String ржП ржХржиржнрж╛рж░рзНржЯ ржХрж░рзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣ржЪрзНржЫрзЗ)
            result = df[df['ID'].astype(str) == str(search_id)]
            
            if not result.empty:
                st.success(f"ржЖрж▓рж╣рж╛ржоржжрзБрж▓рж┐рж▓рзНрж▓рж╛рж╣! ржЖржЗржбрж┐ {search_id}-ржПрж░ рждржерзНржп ржкрж╛ржУрзЯрж╛ ржЧрзЗржЫрзЗред")
                res = result.iloc[0] # ржкрзНрж░ржержо рж░рзЗржЬрж╛рж▓рзНржЯржЯрж┐ ржирзЗржУрзЯрж╛
                
                # рж╕рзБржирзНржжрж░ ржХрж░рзЗ ржмржХрзНрж╕рзЗ рждржерзНржп ржжрзЗржЦрж╛ржирзЛ
                with st.container():
                    st.markdown(f"""
                    <div style="background-color: #ffffff; padding: 20px; border-radius: 10px; border: 1px solid #ddd; box-shadow: 2px 2px 5px rgba(0,0,0,0.1);">
                        <h3 style="color: #008080; margin-top: 0;">ЁЯСд {res['Name']}</h3>
                        <hr>
                        <p><b>ржкрж┐рждрж╛рж░ ржирж╛ржо:</b> {res['Father']}</p>
                        <p><b>ржорж╛рждрж╛рж░ ржирж╛ржо:</b> {res['Mother']}</p>
                        <p><b>ржорзЛржмрж╛ржЗрж▓:</b> {res['Mobile']}</p>
                        <p><b>ржарж┐ржХрж╛ржирж╛:</b> {res['Address']}</p>
                    </div>
                    """, unsafe_allow_html=True)
            else:
                st.error("ржжрзБржГржЦрж┐ржд, ржПржЗ ржЖржЗржбрж┐ ржжрж┐рзЯрзЗ ржХрзЛржирзЛ рждржерзНржп ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржирзЗржЗред")
        else:
            st.warning("ржжрзЯрж╛ ржХрж░рзЗ ржПржХржЯрж┐ ржЖржЗржбрж┐ ржиржорзНржмрж░ ржЯрж╛ржЗржк ржХрж░рзБржиред")
    else:
        st.warning("ржбрж╛ржЯрж╛ржмрзЗрж╕ рж▓рзЛржб рж╣рждрзЗ ржкрж╛рж░ржЫрзЗ ржирж╛ред")

st.write("---")
st.caption("ржЖржкржирж╛рж░ ржЧрзБржЧрж▓ рж╢рж┐ржЯрзЗ ржирждрзБржи рждржерзНржп ржпрзЛржЧ ржХрж░рж▓рзЗ рждрж╛ ржПржЦрж╛ржирзЗ ржЕржЯрзЛржорзЗржЯрж┐ржХ ржЖржкржбрзЗржЯ рж╣рзЯрзЗ ржпрж╛ржмрзЗред")
